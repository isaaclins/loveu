<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>loveu.ch – Crochet Grid Tools</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="page">
        <header class="topbar">
            <div class="brand"><span class="brand-mark">loveu</span><span class="brand-dot">.ch</span></div>
            <div class="tagline">Crochet grid maker & guided stepper</div>
        </header>

        <main class="layout">
            <section class="panel" id="converter">
                <div class="panel-head">
                    <h1>Image → Grid</h1>
                    <p class="muted">Pick an image, choose grid size and number of colors, then export the palette + chart.</p>
                </div>

                <div class="pill-steps">
                    <div class="pill">1. Add photo</div>
                    <div class="pill">2. Set rows & columns</div>
                    <div class="pill">3. Pick colors</div>
                    <div class="pill">4. Press Process</div>
                    <div class="pill">5. Save or send</div>
                </div>

                <div class="controls">
                    <label class="field">Image
                        <input type="file" id="imageInput" accept="image/*">
                    </label>
                    <div class="field-row">
                        <label class="field">Columns
                            <input type="number" id="colsInput" value="30" min="2" max="120" step="1">
                        </label>
                        <label class="field">Rows
                            <input type="number" id="rowsInput" value="30" min="2" max="120" step="1">
                        </label>
                        <label class="field">Colors
                            <input type="number" id="colorsInput" value="5" min="2" max="16" step="1">
                        </label>
                    </div>
                    <div class="actions">
                        <button id="processBtn">Make my grid</button>
                        <button id="downloadJsonBtn" disabled>Download grid (.json)</button>
                        <button id="downloadPngBtn" disabled>Download chart (.png)</button>
                        <button id="sendToGuideBtn" disabled>Send to guided stepper</button>
                    </div>
                </div>

                <div class="helper-card">
                    <div class="helper-title">Zero-confusion mode</div>
                    <ul class="helper-list">
                        <li>Tap <strong>Choose file</strong> and pick any photo or screenshot.</li>
                        <li>If you are unsure, leave the numbers as-is. They already work well.</li>
                        <li>Press <strong>Make my grid</strong> and wait a second — the preview fills itself.</li>
                        <li>Save the chart or press <strong>Send to guided stepper</strong> to start stitching.</li>
                    </ul>
                </div>

                <div class="preview-grid">
                    <div class="preview-block">
                        <h3>Original</h3>
                        <div class="canvas-wrap"><canvas id="originalCanvas"></canvas></div>
                    </div>
                    <div class="preview-block">
                        <h3>Quantized Grid</h3>
                        <div class="canvas-wrap"><canvas id="gridCanvas"></canvas></div>
                    </div>
                    <div class="preview-block">
                        <h3>Palette</h3>
                        <div id="paletteSwatches" class="palette"></div>
                    </div>
                </div>
            </section>

            <section class="panel" id="guided">
                <div class="panel-head">
                    <h1>Guided Stepper</h1>
                    <p class="muted">Import a saved grid to get color-by-color runs with a visual cursor.</p>
                </div>

                <div class="pill-steps">
                    <div class="pill">1. Load grid</div>
                    <div class="pill">2. Press Next</div>
                    <div class="pill">3. Follow highlighted row</div>
                    <div class="pill">4. Undo if needed</div>
                </div>

                <div class="controls">
                    <label class="field">Import grid (.json)
                        <input type="file" id="gridInput" accept="application/json">
                    </label>
                    <div class="actions">
                        <button id="useLastBtn" disabled>Use last converted grid</button>
                        <button id="resetGuideBtn" disabled>Reset</button>
                    </div>
                </div>

                <div class="helper-card">
                    <div class="helper-title">How to step through</div>
                    <ul class="helper-list">
                        <li>Press <strong>Use last converted grid</strong> or import a saved file.</li>
                        <li>Tap <strong>Next</strong> — the highlighted bar shows exactly what to stitch.</li>
                        <li>Need to go back? Tap <strong>Undo</strong> or the <strong>Back</strong> button.</li>
                        <li>Keep tapping <strong>Next</strong> until the progress bar reaches 100%.</li>
                    </ul>
                </div>

                <div class="guide-layout">
                    <div class="guide-card">
                        <div class="guide-meta" id="guideMeta">No grid loaded.</div>
                        <div class="guide-current" id="guideCurrent">—</div>
                        <div class="guide-next" id="guideNext">Next: —</div>
                        <div class="guide-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill"></div>
                            </div>
                            <span id="progressText">0%</span>
                        </div>
                        <div class="actions">
                            <button id="backBtn" disabled>Back</button>
                            <button id="undoBtn" disabled>Undo</button>
                            <button id="nextBtn" disabled>Next</button>
                        </div>
                    </div>
                    <div class="guide-visual">
                        <div class="canvas-wrap"><canvas id="guideCanvas"></canvas></div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>
